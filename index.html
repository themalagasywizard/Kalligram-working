<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kalligram - AI Writing Assistant</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Add Supabase -->
    <script type="module">
        import { auth } from './lib/supabase.js';
        
        // Check if user is already logged in
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const { data: { user } } = await auth.getUser();
                if (user) {
                    // If user is logged in, redirect to the main app
                    window.location.href = '/app.html';
                }
            } catch (error) {
                console.error('Auth check error:', error);
            }
        });
    </script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        indigo: {
                            50: '#EEF2FF',
                            100: '#E0E7FF',
                            500: '#6366F1',
                            600: '#4F46E5',
                            700: '#4338CA'
                        }
                    }
                }
            }
        }
    </script>
</head>
<<<<<<< HEAD
<body class="bg-white text-gray-800 font-sans">
    <!-- Navigation -->
    <header class="sticky top-0 z-50 bg-white shadow-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <a href="#" class="text-2xl font-bold text-indigo-600">Kalligram</a>
=======
<body class="h-screen flex flex-col">
    <script type="module">
        import { projects, chapters, characters, auth } from './lib/supabase.js';
        
        // Global state management
        const appState = {
            currentProject: null,
            currentChapter: null,
            currentUser: null,
            isDirty: false, // Track if editor has unsaved changes
            wordTarget: 1000, // Default target word count
        };

        // DOM Elements
        const elements = {
            projectTitle: document.getElementById('projectTitle'),
            lastEdited: document.getElementById('lastEdited'),
            chaptersList: document.getElementById('chaptersList'),
            addChapterBtn: document.getElementById('addChapterBtn'),
            saveBtn: document.getElementById('saveBtn'),
            newProjectBtn: document.getElementById('newProjectBtn'),
            editorContent: document.getElementById('editorContent'),
            chapterTitle: document.getElementById('chapterTitle'),
            wordCount: document.getElementById('wordCount'),
            wordCountProgress: document.getElementById('wordCountProgress'),
            wordCountPercent: document.getElementById('wordCountPercent'),
            contextCount: document.getElementById('contextCount'),
            contextList: document.getElementById('contextList'),
            saveStatus: document.getElementById('saveStatus'),
            
            // New Project Modal
            newProjectModal: document.getElementById('newProjectModal'),
            newProjectTitle: document.getElementById('newProjectTitle'),
            newProjectDescription: document.getElementById('newProjectDescription'),
            closeNewProjectModal: document.getElementById('closeNewProjectModal'),
            cancelNewProject: document.getElementById('cancelNewProject'),
            createNewProject: document.getElementById('createNewProject'),
            
            // Loading overlay
            loadingOverlay: document.getElementById('loadingOverlay'),
            loadingMessage: document.getElementById('loadingMessage'),
            loadProjectBtn: document.getElementById('loadProjectBtn'),
        };

        // Helper Functions
        function showLoading(message = 'Loading...') {
            elements.loadingMessage.textContent = message;
            elements.loadingOverlay.classList.remove('hidden');
            elements.loadingOverlay.classList.add('flex');
        }

        function hideLoading() {
            elements.loadingOverlay.classList.add('hidden');
            elements.loadingOverlay.classList.remove('flex');
        }

        function formatDate(dateString) {
            if (!dateString) return 'Never';
            const date = new Date(dateString);
            return date.toLocaleString();
        }

        function countWords(text) {
            // Remove HTML tags and count words
            const cleanText = text.replace(/<[^>]*>/g, '');
            const words = cleanText.trim().split(/\s+/);
            return words.length;
        }

        function updateWordCount() {
            if (!appState.currentChapter) return;
            
            const content = elements.editorContent.innerHTML;
            const count = countWords(content);
            
            // Update the display
            elements.wordCount.textContent = count.toLocaleString();
            
            // Calculate percentage of target
            const percentage = Math.min(Math.round((count / appState.wordTarget) * 100), 100);
            elements.wordCountProgress.setAttribute('stroke-dasharray', `${percentage} 100`);
            elements.wordCountPercent.textContent = `${percentage}%`;
        }

        // Project Functions
        async function loadProjects() {
            try {
                showLoading('Loading projects...');
                
                const { data: userProjects, error } = await projects.getAll();
                
                if (error) throw error;
                
                if (!userProjects || userProjects.length === 0) {
                    // No projects yet, show empty state
                    elements.projectTitle.textContent = 'No projects yet';
                    elements.lastEdited.textContent = 'Create a new project to get started';
                    hideLoading();
                    return;
                }
                
                // Get the last loaded project ID from localStorage
                const lastProjectId = localStorage.getItem('lastProjectId');
                
                // Find the last loaded project or default to the first project
                let currentProject = userProjects[0];
                if (lastProjectId) {
                    const foundProject = userProjects.find(p => p.id === lastProjectId);
                    if (foundProject) {
                        currentProject = foundProject;
                    }
                }
                
                // Set the current project
                appState.currentProject = currentProject;
                
                // Update UI with project info
                updateProjectUI(appState.currentProject);
                
                // Load chapters for this project
                await loadChapters(appState.currentProject.id);
                
                hideLoading();
            } catch (error) {
                console.error('Error loading projects:', error);
                elements.projectTitle.textContent = 'Error loading projects';
                elements.lastEdited.textContent = 'Please try again';
                hideLoading();
            }
        }

        function updateProjectUI(project) {
            if (!project) return;
            
            elements.projectTitle.textContent = project.title;
            elements.lastEdited.textContent = 'Last edited: ' + formatDate(project.updated_at);
        }

        async function createProject(title, description) {
            try {
                showLoading('Creating project...');
                
                const { data: newProject, error } = await projects.create(title, description);
                
                if (error) throw error;
                
                if (!newProject || newProject.length === 0) {
                    throw new Error('Failed to create project');
                }
                
                // Set as current project
                appState.currentProject = newProject[0];
                
                // Save the new project ID to localStorage
                localStorage.setItem('lastProjectId', newProject[0].id);
                
                // Update UI
                updateProjectUI(appState.currentProject);
                
                // Create first chapter
                await createChapter('Chapter 1: Introduction', '', 0);
                
                hideLoading();
                
                return newProject[0];
            } catch (error) {
                console.error('Error creating project:', error);
                hideLoading();
                return null;
            }
        }

        // Chapter Functions
        async function loadChapters(projectId) {
            try {
                if (!projectId) return;
                
                elements.chaptersList.innerHTML = '<div class="text-center p-2 text-textSecondary text-sm"><i class="fas fa-spinner fa-spin mr-2"></i>Loading chapters...</div>';
                
                const { data: projectChapters, error } = await chapters.getByProject(projectId);
                
                if (error) throw error;
                
                // Clear chapters list
                elements.chaptersList.innerHTML = '';
                
                if (!projectChapters || projectChapters.length === 0) {
                    elements.chaptersList.innerHTML = '<div class="text-center p-2 text-textSecondary text-sm"><i class="fas fa-info-circle mr-2"></i>No chapters yet</div>';
                    return;
                }
                
                // Sort chapters by order_index
                projectChapters.sort((a, b) => a.order_index - b.order_index);
                
                // Add chapters to the list
                projectChapters.forEach((chapter, index) => {
                    const chapterElement = document.createElement('div');
                    chapterElement.className = 'chapter-item p-2 pl-3 rounded cursor-pointer';
                    chapterElement.setAttribute('data-chapter-id', chapter.id);
                    chapterElement.setAttribute('draggable', 'true');
                    
                    chapterElement.innerHTML = `
                        <div class="flex items-center justify-between">
                            <span class="chapter-title">${chapter.title}</span>
                            <i class="fas fa-grip-lines text-gray-300 cursor-move handle"></i>
                        </div>
                    `;
                    
                    // Add click handler
                    chapterElement.addEventListener('click', () => selectChapter(chapter));
                    
                    // Add double-click handler for renaming
                    chapterElement.addEventListener('dblclick', (e) => {
                        if (e.target.closest('.handle')) return; // Don't trigger rename when clicking the handle
                        
                        const titleSpan = chapterElement.querySelector('.chapter-title');
                        const currentTitle = titleSpan.textContent;
                        
                        // Create input for editing
                        const input = document.createElement('input');
                        input.type = 'text';
                        input.className = 'w-full p-0 border-none focus:ring-0 bg-primaryLight rounded';
                        input.value = currentTitle;
                        
                        // Replace span with input
                        titleSpan.replaceWith(input);
                        input.focus();
                        input.select();
                        
                        // Save on blur or Enter key
                        const saveChapterTitle = async () => {
                            const newTitle = input.value.trim();
                            if (newTitle && newTitle !== currentTitle) {
                                try {
                                    // Update chapter title in database
                                    const { data: updatedChapter, error } = await chapters.update(
                                        chapter.id,
                                        { title: newTitle }
                                    );
                                    
                                    if (error) throw error;
                                    
                                    // Update local state if this is the current chapter
                                    if (appState.currentChapter && appState.currentChapter.id === chapter.id) {
                                        appState.currentChapter = updatedChapter[0];
                                        elements.chapterTitle.textContent = newTitle;
                                    }
                                    
                                    showToast('Chapter renamed', 'success');
                                } catch (error) {
                                    console.error('Error renaming chapter:', error);
                                    showToast('Failed to rename chapter', 'error');
                                }
                            }
                            
                            // Restore span with updated or original title
                            const newSpan = document.createElement('span');
                            newSpan.className = 'chapter-title';
                            newSpan.textContent = newTitle || currentTitle;
                            input.replaceWith(newSpan);
                        };
                        
                        input.addEventListener('blur', saveChapterTitle);
                        input.addEventListener('keydown', (e) => {
                            if (e.key === 'Enter') {
                                e.preventDefault();
                                saveChapterTitle();
                            } else if (e.key === 'Escape') {
                                e.preventDefault();
                                const newSpan = document.createElement('span');
                                newSpan.className = 'chapter-title';
                                newSpan.textContent = currentTitle;
                                input.replaceWith(newSpan);
                            }
                        });
                    });
                    
                    // Add drag and drop functionality
                    chapterElement.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', chapter.id);
                        e.dataTransfer.effectAllowed = 'move';
                        chapterElement.classList.add('bg-primaryLight');
                    });
                    
                    chapterElement.addEventListener('dragend', () => {
                        chapterElement.classList.remove('bg-primaryLight');
                    });
                    
                    chapterElement.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                    });
                    
                    chapterElement.addEventListener('dragenter', (e) => {
                        e.preventDefault();
                        chapterElement.classList.add('border', 'border-primary');
                    });
                    
                    chapterElement.addEventListener('dragleave', () => {
                        chapterElement.classList.remove('border', 'border-primary');
                    });
                    
                    chapterElement.addEventListener('drop', async (e) => {
                        e.preventDefault();
                        chapterElement.classList.remove('border', 'border-primary');
                        
                        const draggedChapterId = e.dataTransfer.getData('text/plain');
                        if (!draggedChapterId || draggedChapterId === chapter.id) return;
                        
                        try {
                            // Get all chapters in current order
                            const chapterElements = Array.from(elements.chaptersList.querySelectorAll('.chapter-item'));
                            const draggedElement = elements.chaptersList.querySelector(`[data-chapter-id="${draggedChapterId}"]`);
                            const dropElement = chapterElement;
                            
                            // Get current indices
                            const draggedIndex = chapterElements.indexOf(draggedElement);
                            const dropIndex = chapterElements.indexOf(dropElement);
                            
                            // Move element in DOM
                            if (draggedIndex < dropIndex) {
                                // Moving down
                                dropElement.parentNode.insertBefore(draggedElement, dropElement.nextElementSibling);
                            } else {
                                // Moving up
                                dropElement.parentNode.insertBefore(draggedElement, dropElement);
                            }
                            
                            // Update order_index values
                            const updatedChapters = Array.from(elements.chaptersList.querySelectorAll('.chapter-item'))
                                .map((el, idx) => ({
                                    id: el.getAttribute('data-chapter-id'),
                                    order_index: idx
                                }));
                            
                            // Show saving indicator
                            showToast('Updating chapter order...', 'success');
                            
                            // Update database
                            const { error } = await chapters.updateOrder(updatedChapters);
                            
                            if (error) {
                                console.error('Error updating chapter order:', error);
                                showToast('Failed to update chapter order: ' + (error.message || 'Unknown error'), 'error');
                                // Reload chapters to restore original order
                                await loadChapters(projectId);
                                return;
                            }
                            
                            showToast('Chapter order updated', 'success');
                        } catch (error) {
                            console.error('Error updating chapter order:', error);
                            showToast('Failed to update chapter order', 'error');
                            // Reload chapters to restore original order
                            await loadChapters(projectId);
                        }
                    });
                    
                    elements.chaptersList.appendChild(chapterElement);
                });
                
                // Select the first chapter by default
                if (projectChapters.length > 0) {
                    selectChapter(projectChapters[0]);
                }
            } catch (error) {
                console.error('Error loading chapters:', error);
                elements.chaptersList.innerHTML = '<div class="text-center p-2 text-textSecondary text-sm"><i class="fas fa-exclamation-circle mr-2 text-error"></i>Error loading chapters</div>';
            }
        }

        function selectChapter(chapter) {
            if (!chapter) return;
            
            // Save current chapter if it exists and has changes
            if (appState.currentChapter && appState.isDirty) {
                saveCurrentChapter();
            }
            
            // Set as current chapter
            appState.currentChapter = chapter;
            
            // Highlight the selected chapter
            const chapterItems = document.querySelectorAll('.chapter-item');
            chapterItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-chapter-id') === chapter.id) {
                    item.classList.add('active');
                }
            });
            
            // Update editor content
            elements.chapterTitle.textContent = chapter.title;
            elements.editorContent.innerHTML = chapter.content || '<p class="mb-4">Start writing your story here...</p>';
            
            // Reset dirty state
            appState.isDirty = false;
            updateSaveStatus(false);
            
            // Update word count
            updateWordCount();
        }

        async function createChapter(title, content, orderIndex) {
            try {
                if (!appState.currentProject) {
                    throw new Error('No current project');
                }
                
                showLoading('Creating chapter...');
                
                const { data: newChapter, error } = await chapters.create(
                    appState.currentProject.id,
                    title, 
                    content || '', 
                    orderIndex
                );
                
                if (error) throw error;
                
                if (!newChapter || newChapter.length === 0) {
                    throw new Error('Failed to create chapter');
                }
                
                // Reload chapters
                await loadChapters(appState.currentProject.id);
                
                // Select the new chapter
                selectChapter(newChapter[0]);
                
                hideLoading();
                
                return newChapter[0];
            } catch (error) {
                console.error('Error creating chapter:', error);
                hideLoading();
                return null;
            }
        }

        async function saveCurrentChapter() {
            try {
                if (!appState.currentChapter) return;
                
                // Get content from editor
                const content = elements.editorContent.innerHTML;
                
                // Update save button to indicate saving in progress
                elements.saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i><span class="ml-1">Saving...</span>';
                
                const { data: updatedChapter, error } = await chapters.update(
                    appState.currentChapter.id,
                    {
                        content: content,
                        updated_at: new Date().toISOString()
                    }
                );
                
                if (error) throw error;
                
                // Update current chapter
                appState.currentChapter = updatedChapter[0];
                
                // Reset dirty state
                appState.isDirty = false;
                
                // Update save button to indicate saved
                elements.saveBtn.classList.remove('btn-error');
                elements.saveBtn.classList.add('btn-primary');
                elements.saveBtn.innerHTML = '<i class="fas fa-save"></i><span class="ml-1">Save</span>';
                
                // Update project last edited time (backend will handle this)
                elements.lastEdited.textContent = 'Last edited: ' + formatDate(new Date());
                
                // Update word count
                updateWordCount();
                
                return updatedChapter[0];
            } catch (error) {
                console.error('Error saving chapter:', error);
                
                // Update save button to indicate error
                elements.saveBtn.classList.remove('btn-primary');
                elements.saveBtn.classList.add('btn-error');
                elements.saveBtn.innerHTML = '<i class="fas fa-exclamation-circle"></i><span class="ml-1">Error</span>';
                
                // Show toast with error message
                showToast('Error saving chapter', 'error');
                
                return null;
            }
        }

        function updateSaveStatus(isDirty, message) {
            appState.isDirty = isDirty;
            
            // Update save button appearance based on dirty state
            if (isDirty) {
                elements.saveBtn.classList.remove('btn-primary');
                elements.saveBtn.classList.add('btn-error');
            } else {
                elements.saveBtn.classList.remove('btn-error');
                elements.saveBtn.classList.add('btn-primary');
            }
            
            // If message is provided, show it in a toast notification
            if (message) {
                showToast(message);
            }
        }

        // Context Management
        async function loadContextItems() {
            try {
                if (!appState.currentProject) return;
                
                // Load characters
                const { data: projectCharacters, error: charError } = await characters.getByProject(appState.currentProject.id);
                
                if (charError) throw charError;
                
                // TODO: Load settings and timeline events when those functions are implemented
                
                // Clear context list
                elements.contextList.innerHTML = '';
                
                // Count total context items
                const totalItems = (projectCharacters?.length || 0);
                elements.contextCount.textContent = totalItems + ' items';
                
                if (totalItems === 0) {
                    elements.contextList.innerHTML = '<div class="text-center p-2 text-textSecondary text-sm"><i class="fas fa-info-circle mr-2"></i>No context items yet</div>';
                    return;
                }
                
                // Add characters to the list
                if (projectCharacters && projectCharacters.length > 0) {
                    projectCharacters.forEach(character => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'p-2 text-sm hover:bg-gray-50 rounded cursor-pointer';
                        
                        itemElement.innerHTML = `
                            <div class="font-medium">${character.name}</div>
                            <div class="text-xs text-textSecondary">${character.role}</div>
                        `;
                        
                        elements.contextList.appendChild(itemElement);
                    });
                }
                
                // TODO: Add settings and timeline events to the list
            } catch (error) {
                console.error('Error loading context items:', error);
                elements.contextList.innerHTML = '<div class="text-center p-2 text-textSecondary text-sm"><i class="fas fa-exclamation-circle mr-2 text-error"></i>Error loading context</div>';
            }
        }

        // Show toast message
        function showToast(message, type = 'success') {
            const toast = document.getElementById('aiToast');
            if (!toast) return; // Exit if toast element isn't available
            
            const toastText = toast.querySelector('p');
            if (toastText) toastText.textContent = message;
            
            toast.classList.remove('hidden');
            toast.classList.add('transform', 'translate-y-0');
            
            if (type === 'success') {
                toast.classList.add('bg-success');
                toast.classList.remove('bg-error');
            } else {
                toast.classList.add('bg-error');
                toast.classList.remove('bg-success');
            }
            
            setTimeout(() => {
                toast.classList.add('translate-y-full');
                setTimeout(() => {
                    toast.classList.add('hidden');
                    toast.classList.remove('translate-y-full', 'bg-success', 'bg-error');
                }, 300);
            }, 3000);
        }

        // Toggle Load Project Panel
        function toggleLoadProjectPanel() {
            const panel = document.getElementById('loadProjectPanel');
            const overlay = document.getElementById('loadProjectOverlay');
            const isOpen = !panel.classList.contains('translate-x-full');

            if (isOpen) {
                panel.classList.add('translate-x-full');
                overlay.classList.add('hidden');
            } else {
                panel.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
            }
        }

        // Load User Projects
        async function loadUserProjects() {
            const projectsList = document.getElementById('projectsList');
            projectsList.innerHTML = '<div class="text-center text-gray-500"><i class="fas fa-spinner fa-spin"></i> Loading projects...</div>';

            try {
                const { data: userProjects, error } = await projects.getAll();
                
                if (error) throw error;

                if (!userProjects || userProjects.length === 0) {
                    projectsList.innerHTML = `
                        <div class="text-center text-gray-500">
                            <i class="fas fa-folder-open text-2xl mb-2"></i>
                            <p>No projects found</p>
                        </div>
                    `;
                    return;
                }

                // Sort projects by last updated
                userProjects.sort((a, b) => new Date(b.updated_at) - new Date(a.updated_at));

                // Create project list HTML
                projectsList.innerHTML = userProjects.map(project => `
                    <div class="project-item bg-white rounded-lg p-4 border border-gray-200 hover:border-primary cursor-pointer transition-colors"
                         data-project-id="${project.id}">
                        <div class="flex items-center justify-between mb-2">
                            <h3 class="font-medium text-primary">${project.title}</h3>
                            ${project.id === appState.currentProject?.id ? 
                                '<span class="text-xs bg-primary text-white px-2 py-1 rounded">Current</span>' : 
                                ''}
                        </div>
                        <p class="text-sm text-gray-500 mb-2 line-clamp-2">${project.description || 'No description'}</p>
                        <div class="flex items-center justify-between text-xs text-gray-400">
                            <span>
                                <i class="fas fa-clock mr-1"></i>
                                ${formatDate(project.updated_at)}
                            </span>
                            <span>
                                <i class="fas fa-book mr-1"></i>
                                ${project.chapter_count || 0} chapters
                            </span>
                        </div>
                    </div>
                `).join('');

                // Add click handlers to project items
                document.querySelectorAll('.project-item').forEach(item => {
                    item.addEventListener('click', async () => {
                        const projectId = item.dataset.projectId;
                        await switchProject(projectId);
                        toggleLoadProjectPanel();
                    });
                });

            } catch (error) {
                console.error('Error loading projects:', error);
                projectsList.innerHTML = `
                    <div class="text-center text-error">
                        <i class="fas fa-exclamation-circle text-2xl mb-2"></i>
                        <p>Error loading projects</p>
                    </div>
                `;
            }
        }

        // Filter Projects
        function filterProjects(searchTerm) {
            const projectItems = document.querySelectorAll('.project-item');
            projectItems.forEach(item => {
                const title = item.querySelector('h3').textContent.toLowerCase();
                const description = item.querySelector('p').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Switch Project
        async function switchProject(projectId) {
            try {
                showLoading('Loading project...');

                // Save current project if there are unsaved changes
                if (appState.isDirty && appState.currentChapter) {
                    await saveCurrentChapter();
                }

                // Get the new project
                const { data: project, error } = await projects.getById(projectId);
                
                if (error) throw error;
                if (!project) throw new Error('Project not found');

                // Update app state
                appState.currentProject = project;
                appState.currentChapter = null;
                appState.isDirty = false;

                // Save the current project ID to localStorage
                localStorage.setItem('lastProjectId', project.id);

                // Update UI
                updateProjectUI(project);
                await loadChapters(project.id);
                await loadContextItems();

                hideLoading();
                showToast('Project loaded successfully', 'success');
            } catch (error) {
                console.error('Error switching project:', error);
                hideLoading();
                showToast('Error loading project', 'error');
            }
        }

        // Event Listeners
        function setupEventListeners() {
            // New Project Button
            elements.newProjectBtn.addEventListener('click', () => {
                elements.newProjectModal.classList.remove('hidden');
                elements.newProjectModal.classList.add('flex');
                elements.newProjectTitle.focus();
            });
            
            // Close New Project Modal
            elements.closeNewProjectModal.addEventListener('click', () => {
                elements.newProjectModal.classList.add('hidden');
                elements.newProjectModal.classList.remove('flex');
            });
            
            // Cancel New Project
            elements.cancelNewProject.addEventListener('click', () => {
                elements.newProjectModal.classList.add('hidden');
                elements.newProjectModal.classList.remove('flex');
            });
            
            // Create New Project
            elements.createNewProject.addEventListener('click', async () => {
                const title = elements.newProjectTitle.value.trim();
                const description = elements.newProjectDescription.value.trim();
                
                if (!title) {
                    alert('Please enter a project title');
                    return;
                }
                
                elements.newProjectModal.classList.add('hidden');
                elements.newProjectModal.classList.remove('flex');
                
                const newProject = await createProject(title, description);
                
                if (newProject) {
                    // Successfully created project
                    elements.newProjectTitle.value = '';
                    elements.newProjectDescription.value = '';
                }
            });
            
            // Add Chapter Button
            elements.addChapterBtn.addEventListener('click', async () => {
                if (!appState.currentProject) {
                    alert('Please create a project first');
                    return;
                }
                
                // Get the number of existing chapters
                const chapterCount = elements.chaptersList.querySelectorAll('.chapter-item').length;
                const newChapterTitle = `Chapter ${chapterCount + 1}`;
                
                await createChapter(newChapterTitle, '', chapterCount);
            });
            
            // Save Button
            elements.saveBtn.addEventListener('click', () => {
                if (appState.currentChapter) {
                    saveCurrentChapter();
                }
            });
            
            // Editor Content Change
            elements.editorContent.addEventListener('input', () => {
                updateSaveStatus(true);
                updateWordCount();
            });
            
            // Auto-save timer
            setInterval(() => {
                if (appState.isDirty && appState.currentChapter) {
                    saveCurrentChapter();
                }
            }, 60000); // Auto-save every minute if there are changes

            // Load Project Button
            elements.loadProjectBtn.addEventListener('click', () => {
                toggleLoadProjectPanel();
                loadUserProjects();
            });

            // Close Load Project Panel
            document.getElementById('closeLoadProjectPanel').addEventListener('click', toggleLoadProjectPanel);
            document.getElementById('loadProjectOverlay').addEventListener('click', toggleLoadProjectPanel);

            // Project Search
            document.getElementById('projectSearch').addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase();
                filterProjects(searchTerm);
            });

            // Formatting buttons
            document.querySelector('button[title="Bold"]').addEventListener('click', () => {
                document.execCommand('bold', false, null);
                updateSaveStatus(true);
            });

            document.querySelector('button[title="Italic"]').addEventListener('click', () => {
                document.execCommand('italic', false, null);
                updateSaveStatus(true);
            });

            document.querySelector('button[title="Heading"]').addEventListener('click', () => {
                const selection = window.getSelection();
                const range = selection.getRangeAt(0);
                const container = range.commonAncestorContainer.parentElement;
                
                // Create a new div for the heading
                const headingDiv = document.createElement('div');
                headingDiv.className = 'text-center text-2xl font-bold my-4';
                
                // If we're already in a centered heading, revert to normal
                if (container.classList && container.classList.contains('text-center')) {
                    // Remove the heading formatting
                    const normalText = document.createElement('div');
                    normalText.innerHTML = container.innerHTML;
                    container.parentNode.replaceChild(normalText, container);
                } else {
                    // Apply heading formatting
                    headingDiv.innerHTML = range.toString();
                    range.deleteContents();
                    range.insertNode(headingDiv);
                }
                
                updateSaveStatus(true);
            });

            // Font size button and dropdown
            const fontSizeBtn = document.querySelector('button[title="Font Size"]');
            const fontSizeDropdown = document.querySelector('.font-size-dropdown');
            
            // Toggle dropdown
            fontSizeBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                fontSizeDropdown.classList.toggle('hidden');
            });
            
            // Hide dropdown when clicking outside
            document.addEventListener('click', (e) => {
                if (!fontSizeBtn.contains(e.target)) {
                    fontSizeDropdown.classList.add('hidden');
                }
            });
            
            // Handle font size selection
            document.querySelectorAll('.font-size-dropdown button').forEach(button => {
                button.addEventListener('click', () => {
                    const size = button.getAttribute('data-size');
                    document.execCommand('fontSize', false, size);
                    fontSizeDropdown.classList.add('hidden');
                    updateSaveStatus(true);
                });
            });

            // Full Screen button
            document.querySelector('button[title="Full Screen"]').addEventListener('click', () => {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        showToast(`Error attempting to enable full-screen mode: ${err.message}`, 'error');
                    });
                } else {
                    document.exitFullscreen().catch(err => {
                        showToast(`Error attempting to exit full-screen mode: ${err.message}`, 'error');
                    });
                }
            });

            // Keyboard shortcuts for formatting
            elements.editorContent.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key.toLowerCase()) {
                        case 'b':
                            e.preventDefault();
                            document.execCommand('bold', false, null);
                            updateSaveStatus(true);
                            break;
                        case 'i':
                            e.preventDefault();
                            document.execCommand('italic', false, null);
                            updateSaveStatus(true);
                            break;
                    }
                }
            });

            // Update formatting buttons state based on current selection
            function updateFormatButtons() {
                const isBold = document.queryCommandState('bold');
                const isItalic = document.queryCommandState('italic');
                const container = window.getSelection().getRangeAt(0).commonAncestorContainer;
                const isHeading = container.nodeType === 1 ? 
                    container.classList && container.classList.contains('text-center') : 
                    container.parentElement.classList && container.parentElement.classList.contains('text-center');

                document.querySelector('button[title="Bold"]').classList.toggle('bg-primaryLight', isBold);
                document.querySelector('button[title="Italic"]').classList.toggle('bg-primaryLight', isItalic);
                document.querySelector('button[title="Heading"]').classList.toggle('bg-primaryLight', isHeading);
            }

            // Add selectionchange event listener to update formatting buttons
            document.addEventListener('selectionchange', () => {
                if (document.activeElement === elements.editorContent) {
                    updateFormatButtons();
                }
            });

            // Update format buttons when clicking in the editor
            elements.editorContent.addEventListener('click', updateFormatButtons);
            elements.editorContent.addEventListener('keyup', updateFormatButtons);

            // Project title rename functionality
            function setupProjectTitleRename() {
                function handleProjectRename() {
                    const currentTitle = elements.projectTitle.textContent;
                    
                    // Create input for editing
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.className = 'w-full p-0 border-none focus:ring-0 bg-primaryLight rounded text-primary font-medium';
                    input.value = currentTitle;
                    
                    // Replace h2 with input
                    elements.projectTitle.replaceWith(input);
                    input.focus();
                    input.select();
                    
                    // Save on blur or Enter key
                    const saveProjectTitle = async () => {
                        const newTitle = input.value.trim();
                        if (newTitle && newTitle !== currentTitle && appState.currentProject) {
                            try {
                                // Update project title in database
                                const { data: updatedProject, error } = await projects.update(
                                    appState.currentProject.id,
                                    { title: newTitle }
                                );
                                
                                if (error) throw error;
                                
                                // Update local state
                                appState.currentProject = updatedProject[0];
                                showToast('Project renamed', 'success');
                            } catch (error) {
                                console.error('Error renaming project:', error);
                                showToast('Failed to rename project', 'error');
                            }
                        }
                        
                        // Restore h2 with updated or original title
                        const newH2 = document.createElement('h2');
                        newH2.id = 'projectTitle';
                        newH2.className = 'text-primary font-medium mb-1 cursor-pointer';
                        newH2.title = 'Double-click to rename';
                        newH2.textContent = newTitle || currentTitle;
                        input.replaceWith(newH2);
                        
                        // Update elements reference and reattach event listener
                        elements.projectTitle = newH2;
                        elements.projectTitle.addEventListener('dblclick', handleProjectRename);
                    };
                    
                    input.addEventListener('blur', saveProjectTitle);
                    input.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            saveProjectTitle();
                        } else if (e.key === 'Escape') {
                            e.preventDefault();
                            const newH2 = document.createElement('h2');
                            newH2.id = 'projectTitle';
                            newH2.className = 'text-primary font-medium mb-1 cursor-pointer';
                            newH2.title = 'Double-click to rename';
                            newH2.textContent = currentTitle;
                            input.replaceWith(newH2);
                            
                            // Update elements reference and reattach event listener
                            elements.projectTitle = newH2;
                            elements.projectTitle.addEventListener('dblclick', handleProjectRename);
                        }
                    });
                }

                // Initial event listener attachment
                elements.projectTitle.addEventListener('dblclick', handleProjectRename);
            }

            // Call the setup function
            setupProjectTitleRename();
        }

        // Initialization
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                // Check if user is authenticated
                const { data: { user } } = await auth.getUser();
                if (!user) {
                    window.location.href = '/auth/auth.html';
                    return;
                }
                
                appState.currentUser = user;
                
                // Setup UI event listeners
                setupEventListeners();
                
                // Load projects
                await loadProjects();
                
                // Load context items
                await loadContextItems();
                
            } catch (error) {
                console.error('Error initializing app:', error);
                hideLoading();
            }
        });
    </script>

    <script type="module">
        import { auth } from './lib/supabase.js';
        
        // Initialize with a default user avatar and handle sign out
        document.addEventListener('DOMContentLoaded', () => {
            const userAvatar = document.querySelector('#userAvatar');
            const userDisplayName = document.querySelector('#userDisplayName');
            const signOutBtn = document.querySelector('#signOutBtn');
            
            // Update user info if authenticated
            auth.getUser().then(({ data: { user } }) => {
                if (user && userAvatar) {
                    // Update avatar with user email or name
                    const nameInitial = user.email ? user.email.charAt(0).toUpperCase() : 'G';
                    userAvatar.src = `https://ui-avatars.com/api/?name=${nameInitial}&background=4B5EAA&color=fff`;
                    
                    // Update user display name
                    if (userDisplayName) {
                        userDisplayName.textContent = user.email || 'Signed In User';
                    }
                }
            }).catch(error => {
                console.error('Auth check error:', error);
            });
            
            // Add sign out handler
            if (signOutBtn) {
                signOutBtn.addEventListener('click', async () => {
                    try {
                        await auth.signOut();
                        window.location.href = '/auth/auth.html';
                    } catch (error) {
                        console.error('Error signing out:', error);
                        alert('Failed to sign out. Please try again.');
                    }
                });
            }
        });
    </script>

    <!-- Top Bar -->
    <header class="h-16 bg-white border-b border-gray-100 flex items-center justify-between px-6 shadow-sm-custom">
        <div class="flex items-center space-x-4">
            <!-- Mobile Menu Button -->
            <button id="mobileMenuBtn" class="lg:hidden text-gray-500 hover:text-primary">
                <i class="fas fa-bars"></i>
            </button>
            <div class="w-10 h-10 bg-primary rounded-full flex items-center justify-center text-white text-xl">
                <i class="fas fa-feather-alt"></i>
            </div>
            <h1 class="text-xl font-semibold text-primary hidden md:block">Kalligram</h1>
        </div>
        <div class="flex items-center space-x-4">
            <button id="saveBtn" class="btn btn-primary">
                <i class="fas fa-save"></i>
                <span class="ml-1">Save</span>
            </button>
            <button id="loadProjectBtn" class="btn btn-primary">
                <i class="fas fa-folder-open"></i>
                <span class="ml-1">Load Project</span>
            </button>
            <button id="newProjectBtn" class="btn btn-success">
                <i class="fas fa-plus"></i>
                <span class="ml-1">New Project</span>
            </button>
            <div class="relative group">
                <img id="userAvatar" src="https://ui-avatars.com/api/?name=Guest&background=4B5EAA&color=fff" 
                     alt="User Avatar" 
                     class="w-9 h-9 rounded-full cursor-pointer border-2 border-white hover:border-primary transition-colors">
                <div class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-md-custom p-2 invisible opacity-0 group-hover:visible group-hover:opacity-100 transition-all z-10">
                    <div class="p-2 hover:bg-gray-50 rounded cursor-pointer flex items-center">
                        <i class="fas fa-user-circle text-primary mr-2"></i>
                        <span id="userDisplayName">Guest User</span>
                    </div>
                    <div class="p-2 hover:bg-gray-50 rounded cursor-pointer flex items-center">
                        <i class="fas fa-cog text-secondary mr-2"></i>
                        <span>Settings</span>
                    </div>
                    <div id="signOutBtn" class="p-2 hover:bg-gray-50 rounded cursor-pointer flex items-center text-error">
                        <i class="fas fa-sign-out-alt mr-2"></i>
                        <span>Sign Out</span>
                    </div>
>>>>>>> a18c8678fcfd16d511439bc217ad07d653501626
                </div>

                <!-- Desktop Navigation -->
                <nav class="hidden md:flex space-x-10">
                    <a href="#features" class="text-gray-600 hover:text-indigo-600 transition duration-300">Features</a>
                    <a href="#how-it-works" class="text-gray-600 hover:text-indigo-600 transition duration-300">How It Works</a>
                    <a href="#testimonials" class="text-gray-600 hover:text-indigo-600 transition duration-300">Testimonials</a>
                    <a href="#pricing" class="text-gray-600 hover:text-indigo-600 transition duration-300">Pricing</a>
                    <a href="#faq" class="text-gray-600 hover:text-indigo-600 transition duration-300">FAQ</a>
                </nav>

                <div class="flex items-center space-x-4">
                    <a href="/auth/auth.html" class="hidden md:inline-block px-6 py-2 rounded-md bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition duration-300">
                        Get Started
                    </a>
                    <button id="mobileMenuBtn" class="md:hidden p-2 rounded-md text-gray-600 focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu -->
        <div id="mobileMenu" class="md:hidden bg-white pb-4 border-t hidden">
            <div class="container mx-auto px-4 space-y-3">
                <a href="#features" class="block text-gray-600 hover:text-indigo-600 transition duration-300">Features</a>
                <a href="#how-it-works" class="block text-gray-600 hover:text-indigo-600 transition duration-300">How It Works</a>
                <a href="#testimonials" class="block text-gray-600 hover:text-indigo-600 transition duration-300">Testimonials</a>
                <a href="#pricing" class="block text-gray-600 hover:text-indigo-600 transition duration-300">Pricing</a>
                <a href="#faq" class="block text-gray-600 hover:text-indigo-600 transition duration-300">FAQ</a>
                <a href="/auth/auth.html" class="block text-center px-6 py-2 rounded-md bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition duration-300">
                    Get Started
                </a>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="relative overflow-hidden bg-gradient-to-br from-indigo-50 to-white">
        <div class="absolute inset-0 opacity-20">
            <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%">
                <defs>
                    <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                        <path d="M 40 0 L 0 0 0 40" fill="none" stroke="black" stroke-width="0.5" />
                    </pattern>
                </defs>
                <rect width="100%" height="100%" fill="url(#grid)" />
            </svg>
        </div>

        <div class="container mx-auto px-4 sm:px-6 lg:px-8 pt-16 pb-24 relative z-10">
            <div class="max-w-3xl mx-auto text-center">
                <span class="inline-block px-3 py-1 mb-4 text-sm font-medium text-indigo-600 bg-indigo-100 rounded-full">
                    AI-Powered Book Writing Assistant
                </span>
                <h1 class="text-4xl sm:text-5xl lg:text-6xl font-extrabold tracking-tight mb-6">
                    Write Your Book With <span class="text-indigo-600">Artificial Intelligence</span>
                </h1>
                <p class="text-lg sm:text-xl text-gray-600 mb-10 leading-relaxed">
                    Kalligram helps you craft compelling stories and books using advanced AI writing tools that understand your voice and style.
                </p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <a href="/auth/auth.html" class="px-8 py-3 rounded-md bg-indigo-600 text-white font-medium hover:bg-indigo-700 transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        Start Writing Today
                    </a>
                    <a href="#demo" class="px-8 py-3 rounded-md bg-white text-indigo-600 font-medium border border-indigo-600 hover:bg-indigo-50 transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5">
                        Watch Demo
                    </a>
                </div>
            </div>

            <div class="mt-16 max-w-5xl mx-auto">
                <div class="rounded-2xl overflow-hidden shadow-2xl transform hover:scale-[1.01] transition duration-300">
                    <img src="https://picsum.photos/id/1074/1200/600" alt="Kalligram Editor Interface" class="w-full h-auto">
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section id="features" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">Powerful Features to Enhance Your Writing</h2>
                <p class="text-lg text-gray-600">
                    Kalligram offers a comprehensive suite of tools designed to streamline your creative process and boost productivity.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Feature Cards -->
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">AI Story Generator</h3>
                    <p class="text-gray-600">Generate compelling story ideas, plot outlines, and character profiles with our advanced AI model.</p>
                </div>

                <!-- Add remaining feature cards -->
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Smart Autocomplete</h3>
                    <p class="text-gray-600">Get intelligent suggestions as you write to overcome writer's block and maintain momentum.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Grammar & Style Checker</h3>
                    <p class="text-gray-600">Real-time grammar checking and style improvement suggestions for polished, professional writing.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Character Development Tools</h3>
                    <p class="text-gray-600">Create detailed character profiles with personality traits, motivations, and development arcs.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Scene Planner</h3>
                    <p class="text-gray-600">Organize your scenes in a visual timeline to maintain narrative structure and pacing.</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-4">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Collaboration Mode</h3>
                    <p class="text-gray-600">Invite beta readers or co-authors to collaborate on your manuscript in real time.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works Section -->
    <section id="how-it-works" class="py-20 bg-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">How Kalligram Works</h2>
                <p class="text-lg text-gray-600">
                    Getting started is easy. Follow these simple steps to begin crafting your masterpiece.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="text-center">
                    <div class="w-12 h-12 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-xl mx-auto mb-4">
                        1
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Sign Up</h3>
                    <p class="text-gray-600">Create your free account and choose your preferred writing genre.</p>
                </div>

                <div class="text-center">
                    <div class="w-12 h-12 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-xl mx-auto mb-4">
                        2
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Start Writing</h3>
                    <p class="text-gray-600">Use our AI tools to generate ideas, develop characters, and build your outline.</p>
                </div>

                <div class="text-center">
                    <div class="w-12 h-12 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-xl mx-auto mb-4">
                        3
                    </div>
                    <h3 class="text-xl font-semibold mb-2">Polish & Publish</h3>
                    <p class="text-gray-600">Refine your manuscript with editing tools and prepare for publication.</p>
                </div>
            </div>

            <div class="mt-16 max-w-4xl mx-auto">
                <div class="rounded-2xl overflow-hidden shadow-xl">
                    <img src="https://picsum.photos/id/1069/1200/600" alt="Writing Process Demonstration" class="w-full h-auto">
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section id="testimonials" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">What Authors Are Saying</h2>
                <p class="text-lg text-gray-600">
                    Join thousands of writers who have transformed their writing process with Kalligram.
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="flex items-center mb-4">
                        <img src="https://picsum.photos/id/1027/200/200" alt="Sarah Johnson" class="w-12 h-12 rounded-full object-cover mr-4">
                        <div>
                            <h4 class="font-semibold text-gray-900">Sarah Johnson</h4>
                            <p class="text-sm text-gray-500">Novelist</p>
                        </div>
                    </div>
                    <p class="italic text-gray-600">"Kalligram has revolutionized my writing process. The AI suggestions are spot-on and help me push through creative blocks."</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="flex items-center mb-4">
                        <img src="https://picsum.photos/id/1012/200/200" alt="Michael Chen" class="w-12 h-12 rounded-full object-cover mr-4">
                        <div>
                            <h4 class="font-semibold text-gray-900">Michael Chen</h4>
                            <p class="text-sm text-gray-500">Screenwriter</p>
                        </div>
                    </div>
                    <p class="italic text-gray-600">"I've tried many writing tools, but none come close to the intelligence and helpfulness of Kalligram's AI assistant."</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-md hover:shadow-lg transition duration-300 border border-gray-100">
                    <div class="flex items-center mb-4">
                        <img src="https://picsum.photos/id/1062/200/200" alt="Emma Rodriguez" class="w-12 h-12 rounded-full object-cover mr-4">
                        <div>
                            <h4 class="font-semibold text-gray-900">Emma Rodriguez</h4>
                            <p class="text-sm text-gray-500">Self-Published Author</p>
                        </div>
                    </div>
                    <p class="italic text-gray-600">"The collaboration features made working with my editor so much easier. I can't imagine writing without Kalligram now."</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section id="pricing" class="py-20 bg-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">Simple, Transparent Pricing</h2>
                <p class="text-lg text-gray-600">
                    Choose the plan that works best for your writing journey. All plans include access to our core AI features.
                </p>
            </div>

            <div class="max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Starter Plan -->
                <div class="rounded-2xl overflow-hidden border border-gray-200 bg-white">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2">Starter</h3>
                        <div class="mb-4">
                            <span class="text-3xl font-bold">$9</span>
                            <span class="text-gray-500">/month</span>
                        </div>
                        <p class="text-gray-600 mb-6">Perfect for beginning writers exploring AI-assisted writing.</p>
                        <ul class="mb-8 space-y-2">
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Basic AI writing assistance
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                5,000 words per month
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Access to core templates
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Standard support
                            </li>
                        </ul>
                        <button onclick="window.location.href='/auth/auth.html'" class="w-full py-3 rounded-md bg-gray-100 text-gray-800 hover:bg-gray-200 transition duration-300 font-medium">
                            Get Started
                        </button>
                    </div>
                </div>

                <!-- Pro Plan -->
                <div class="rounded-2xl overflow-hidden border border-indigo-500 shadow-xl transform scale-105 bg-white">
                    <div class="bg-indigo-500 text-white text-center py-1 text-sm font-medium">
                        Most Popular
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2">Pro</h3>
                        <div class="mb-4">
                            <span class="text-3xl font-bold">$29</span>
                            <span class="text-gray-500">/month</span>
                        </div>
                        <p class="text-gray-600 mb-6">Ideal for serious writers creating full-length manuscripts.</p>
                        <ul class="mb-8 space-y-2">
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Advanced AI writing tools
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Unlimited words
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                All writing templates
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Priority support
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Collaboration features
                            </li>
                        </ul>
                        <button onclick="window.location.href='/auth/auth.html'" class="w-full py-3 rounded-md bg-indigo-600 text-white hover:bg-indigo-700 transition duration-300 font-medium">
                            Upgrade to Pro
                        </button>
                    </div>
                </div>

                <!-- Enterprise Plan -->
                <div class="rounded-2xl overflow-hidden border border-gray-200 bg-white">
                    <div class="p-6">
                        <h3 class="text-xl font-semibold mb-2">Enterprise</h3>
                        <div class="mb-4">
                            <span class="text-3xl font-bold">Custom</span>
                        </div>
                        <p class="text-gray-600 mb-6">For publishers and writing teams needing custom solutions.</p>
                        <ul class="mb-8 space-y-2">
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Everything in Pro
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Team collaboration
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Custom integrations
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                Dedicated account manager
                            </li>
                            <li class="flex items-start">
                                <svg class="w-5 h-5 text-green-500 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                </svg>
                                API access
                            </li>
                        </ul>
                        <button onclick="window.location.href='/auth/auth.html'" class="w-full py-3 rounded-md bg-gray-100 text-gray-800 hover:bg-gray-200 transition duration-300 font-medium">
                            Contact Sales
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="py-20 bg-gray-50">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center max-w-3xl mx-auto mb-16">
                <h2 class="text-3xl sm:text-4xl font-bold mb-4">Frequently Asked Questions</h2>
                <p class="text-lg text-gray-600">
                    Find answers to common questions about Kalligram and our AI writing tools.
                </p>
            </div>

            <div class="max-w-3xl mx-auto">
                <div class="border-b border-gray-200 py-4">
                    <button class="flex justify-between items-center w-full text-left text-lg font-medium text-gray-900 faq-toggle">
                        Is Kalligram suitable for all genres?
                        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <p class="mt-2 text-gray-600 hidden">Yes! Our AI adapts to various genres including fiction, non-fiction, fantasy, romance, mystery, science fiction, and more.</p>
                </div>

                <div class="border-b border-gray-200 py-4">
                    <button class="flex justify-between items-center w-full text-left text-lg font-medium text-gray-900 faq-toggle">
                        Can I export my work?
                        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <p class="mt-2 text-gray-600 hidden">Absolutely. You can export your manuscripts in multiple formats including Word (.docx), PDF, and plain text.</p>
                </div>

                <div class="border-b border-gray-200 py-4">
                    <button class="flex justify-between items-center w-full text-left text-lg font-medium text-gray-900 faq-toggle">
                        Do I retain ownership of my content?
                        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <p class="mt-2 text-gray-600 hidden">Yes, you retain full ownership of all content you create with Kalligram. We do not claim any rights to your work.</p>
                </div>

                <div class="border-b border-gray-200 py-4">
                    <button class="flex justify-between items-center w-full text-left text-lg font-medium text-gray-900 faq-toggle">
                        Is there a free trial available?
                        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <p class="mt-2 text-gray-600 hidden">Yes, we offer a 7-day free trial of our Pro plan so you can experience all features before committing.</p>
                </div>

                <div class="border-b border-gray-200 py-4">
                    <button class="flex justify-between items-center w-full text-left text-lg font-medium text-gray-900 faq-toggle">
                        Can I use Kalligram offline?
                        <svg class="w-5 h-5 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                        </svg>
                    </button>
                    <p class="mt-2 text-gray-600 hidden">Currently, Kalligram requires an internet connection as it runs in the browser. Offline functionality is planned for future updates.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section id="signup" class="py-20 bg-gradient-to-r from-indigo-600 to-purple-600 text-white">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h2 class="text-3xl sm:text-4xl font-bold mb-6">Ready to Start Writing Your Masterpiece?</h2>
            <p class="text-xl mb-8 max-w-2xl mx-auto">
                Join thousands of authors who are already transforming their writing process with Kalligram's powerful AI tools.
            </p>
            <form id="subscribeForm" class="max-w-md mx-auto flex flex-col sm:flex-row gap-4" onsubmit="window.location.href='/auth/auth.html'; return false;">
                <input
                    type="email"
                    name="email"
                    placeholder="Your email address"
                    required
                    class="flex-grow px-4 py-3 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-indigo-600 focus:ring-white"
                >
                <button
                    type="submit"
                    class="px-6 py-3 rounded-md bg-white text-indigo-600 font-medium hover:bg-indigo-50 transition duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5"
                >
                    Start Free Trial
                </button>
            </form>
            <p class="mt-4 text-sm text-indigo-100">
                No credit card required • 7-day free trial • Cancel anytime
            </p>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-gray-300 py-12">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">Kalligram</h3>
                    <p class="text-gray-400">
                        Revolutionizing the way stories are written with cutting-edge AI technology.
                    </p>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">Product</h3>
                    <ul class="space-y-2">
                        <li><a href="#features" class="text-gray-400 hover:text-white transition duration-300">Features</a></li>
                        <li><a href="#pricing" class="text-gray-400 hover:text-white transition duration-300">Pricing</a></li>
                        <li><a href="#demo" class="text-gray-400 hover:text-white transition duration-300">Demo</a></li>
                        <li><a href="#faq" class="text-gray-400 hover:text-white transition duration-300">FAQ</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">Company</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">About Us</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Blog</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Careers</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Contact</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="text-white text-lg font-semibold mb-4">Legal</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Privacy Policy</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Terms of Service</a></li>
                        <li><a href="#" class="text-gray-400 hover:text-white transition duration-300">Cookie Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-12 pt-8 flex flex-col md:flex-row justify-between items-center">
                <p class="text-gray-400">&copy; 2025 Kalligram. All rights reserved.</p>
                <div class="flex space-x-6 mt-4 md:mt-0">
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" clip-rule="evenodd" />
                        </svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84" />
                        </svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z" clip-rule="evenodd" />
                        </svg>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition duration-300">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" />
                        </svg>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const mobileMenu = document.getElementById('mobileMenu');

        mobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // Email subscription form
        const subscribeForm = document.querySelector('#subscribeForm');
        if (subscribeForm) {
            subscribeForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = e.target.email.value;
                alert(`Thanks for subscribing with email: ${email}`);
                e.target.reset();
            });
        }

        // FAQ toggles
        document.querySelectorAll('.faq-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const content = toggle.nextElementSibling;
                content.classList.toggle('hidden');
                const icon = toggle.querySelector('svg');
                icon.classList.toggle('rotate-180');
            });
        });
    </script>
</body>
</html> 
